import{s as I,u as T}from"./user-512a7649.js";import{_ as z,r as U,o as h,c as f,e as s,u as J,f as m,w as b,g as u,N as C,s as F,O as x,M as B,L as q,P as L,p as E,k as O,a as S,J as j,b as Q,Q as A,d as y,t as d,F as V,h as $,K as D,n as H,l as P,v as X,j as G}from"./index-bfe0d865.js";/* empty css             *//* empty css               */import{u as K}from"./el-input-5f2e33f5.js";import{F as W}from"./Footer-b24d0249.js";/* empty css                                                               */function Y(e){return I({url:"https://api.qjqq.cn/api/qqinfo",method:"get",params:e})}function Z({pageNum:e,pageSize:v}){return I({url:"/msg/list",method:"get",params:{pageNum:e,pageSize:v}})}function ss(e){return I({url:"/msg/save",method:"post",data:e})}function es({id:e}){return I({url:"/msg/msgLike",method:"get",params:{id:e}})}const w=e=>(E("data-v-ac773748"),e=e(),O(),e),ts={class:"setMsg"},os={class:"avatar"},ns=["src"],as={class:"content"},ls={class:"nickName"},cs=w(()=>s("span",null,"昵称",-1)),is={class:"email"},ds=w(()=>s("span",null,"邮箱",-1)),ms={class:"website"},rs=w(()=>s("span",null,"网址",-1)),us={class:"submitMsg"},gs={name:"SetMsgForm"},_s=Object.assign(gs,{props:["setMsg","toCommentId"],emits:["submitMsg"],setup(e,{emit:v}){const r=e,i=v,M=U(!0),l=new URL(""+new URL("../image/defult.png",import.meta.url).href,self.location).href,N=()=>{i("submitMsg",r.setMsg,r.toCommentId)},g=async()=>{if(r.setMsg.nickName=="")return;if(/^[1-9]\d{4,10}$/.test(r.setMsg.nickName)){let{imgurl:c,mail:o,name:_}=await Y({qq:r.setMsg.nickName});r.setMsg.avatar=c,r.setMsg.email=o,r.setMsg.nickName=_,C({title:"找到你啦~",message:"｡:.ﾟヽ(｡◕‿◕｡)ﾉﾟ.:｡+ﾟ",type:"success"})}};return(n,c)=>{const o=F,_=x,a=B,t=q,k=L;return h(),f("div",ts,[s("div",os,[s("img",{src:e.setMsg.avatar||J(l),alt:""},null,8,ns)]),s("div",as,[m(t,{class:"user",gutter:20},{default:b(()=>[m(a,{xs:24,sm:8,md:8},{default:b(()=>[s("div",ls,[cs,m(_,{class:"item",effect:"dark",content:"输入QQ号可自动填充捏╭(●｀∀´●)╯",placement:"top"},{default:b(()=>[m(o,{modelValue:e.setMsg.nickName,"onUpdate:modelValue":c[0]||(c[0]=p=>e.setMsg.nickName=p),placeholder:"必填",onBlur:g},null,8,["modelValue"])]),_:1})])]),_:1}),m(a,{xs:24,sm:8,md:8},{default:b(()=>[s("div",is,[ds,m(o,{modelValue:e.setMsg.email,"onUpdate:modelValue":c[1]||(c[1]=p=>e.setMsg.email=p),placeholder:"必填"},null,8,["modelValue"])])]),_:1}),m(a,{xs:24,sm:8,md:8},{default:b(()=>[s("div",ms,[rs,m(o,{modelValue:e.setMsg.website,"onUpdate:modelValue":c[2]||(c[2]=p=>e.setMsg.website=p),placeholder:"选填"},null,8,["modelValue"])])]),_:1})]),_:1}),m(o,{type:"textarea",rows:2,placeholder:"期待你的发言(⁎⁍̴̛ᴗ⁍̴̛⁎) ",modelValue:e.setMsg.content,"onUpdate:modelValue":c[3]||(c[3]=p=>e.setMsg.content=p),onInput:c[4]||(c[4]=()=>{e.setMsg.content.length==0?M.value=!0:M.value=!1})},null,8,["modelValue"]),s("div",us,[m(k,{type:"primary",disabled:M.value,onClick:N},{default:b(()=>[u("发送")]),_:1},8,["disabled"])])])])}}}),ps=z(_s,[["__scopeId","data-v-ac773748"]]);const hs={name:"msg",components:{ElButton:L,ElRow:q,ElCol:B,ElInput:F,ElTooltip:x,FooterBox:W,SetMsg:ps},setup(){const e=T(),v=K();S(()=>e.blogInfo);const r=S(()=>"background-image: url('image/message_bg_4k.jpg') "),i=U(!0),M=new URL(""+new URL("../image/defult.png",import.meta.url).href,self.location).href,l=j({setMsg:{type:"0",articleId:"0",userId:"13",avatar:"",nickName:"IUHua",eamil:"123@qq.com",website:"http://www.iuhua.love",content:"",userForm:v.city,toCommentId:"",toCommentUserId:""},getMsg:[{id:"1",nickName:"IUHua",avatar:"",website:"",createTime:"10小时前",dzNum:"16",plNum:"3",content:"CV工程师",userForm:"上海",children:[]}],total:0}),N={pageNum:1,pageSize:50};let g="";const n=()=>{g=l.setMsg.nickName,g!=""&&(isNaN(Number(g))||C({title:"找到你啦~",message:"｡:.ﾟヽ(｡◕‿◕｡)ﾉﾟ.:｡+ﾟ",type:"success"}),console.log("修改了昵称"))},c=(a,t)=>{if(l.setMsg=a,l.setMsg.nickName==""||l.setMsg.content==""){C({title:"X达咩X",message:"需要吧信息填写完整",type:"info"});return}t!=null&&t.id?l.setMsg.toCommentId=t==null?void 0:t.id:l.setMsg.toCommentId="",ss(l.setMsg).then(k=>{k.code==200&&(C({title:"么么(* ￣3)(ε￣ *)",message:"留言成功",type:"success"}),a.dzNum=0,a.plNum=0,t!=null&&t.id?(t.children.unshift(JSON.parse(JSON.stringify(a))),t.plNum++):l.getMsg.unshift(JSON.parse(JSON.stringify(a))),l.setMsg.content="")})};let o=()=>{Z(N).then(a=>{a.data.rows.map(t=>{t.openComment=!1}),l.getMsg=a.data.rows,l.total=a.data.total})};const _=(a,t)=>{a==1?es({id:t.id}).then(k=>{t.dzNum++}):(console.log("评论"),t.openComment?t.openComment=!1:(l.getMsg.some(k=>{k.openComment=!1}),t.openComment=!0))};return Q(()=>{o()}),{cover:r,...A(l),isSubmit:i,defultImg:M,getApi:n,submitMsg:c,handleIcon:_}}},R=e=>(E("data-v-eb9a9cc6"),e=e(),O(),e),fs=R(()=>s("div",{class:"banner"},[s("div",{class:"banner-container"},[s("h1",null,"留言板")])],-1)),vs={class:"message-container"},Ms={class:"msgContent"},Ns=R(()=>s("div",{class:"title"},[s("i",{class:"iconfont iconpinglunzu"}),u(" 留言 ")],-1)),ks={class:"title"},bs={class:"getMsg"},Cs={class:"item_msg"},Is={class:"avatar"},ws=["src"],Ss={class:"content"},ys={class:"nickName"},Vs={class:"left"},$s={class:"nickName"},zs={class:"right"},Us=["onClick"],Fs=["onClick"],xs={class:"msg"},Bs={class:"from"},qs={class:"item_comment"},Ls={key:0,class:"write_comment"},Es={class:"comment_box"},Os={class:"item_msg"},Rs={class:"avatar"},Ts=["src"],Js={class:"content"},js={class:"nickName"},Qs={class:"left"},As={class:"nickName"},Ds={class:"right"},Hs=["onClick"],Ps=["onClick"],Xs={class:"msg"},Gs={class:"from"};function Ks(e,v,r,i,M,l){const N=y("SetMsg"),g=y("FooterBox");return h(),f("div",{class:"message-page",style:D(i.cover)},[fs,s("div",vs,[s("div",Ms,[Ns,m(N,{setMsg:e.setMsg,onSubmitMsg:i.submitMsg},null,8,["setMsg","onSubmitMsg"]),s("div",ks,d(e.total?e.total:0)+" 条留言",1),s("div",bs,[(h(!0),f(V,null,$(e.getMsg,(n,c)=>(h(),f("div",{class:H(["msgList",`msg${n.id}`]),key:c},[s("div",Cs,[s("div",Is,[s("img",{src:n.avatar||i.defultImg,alt:""},null,8,ws)]),s("div",Ss,[s("div",ys,[s("div",Vs,[s("span",$s,d(n.nickName),1),u(" "+d(n.createTime||"刚刚"),1)]),s("div",zs,[s("i",{class:"iconfont icondianzan",onClick:o=>i.handleIcon(1,n)},null,8,Us),u(d(n.dzNum)+" ",1),s("i",{class:"iconfont iconpinglunzu",onClick:o=>i.handleIcon(2,n)},null,8,Fs),u(d(n.plNum),1)])]),s("div",xs,d(n.content),1),s("div",Bs,d(n.userForm),1)])]),P(s("div",qs,[n.openComment?(h(),f("div",Ls,[m(N,{setMsg:e.setMsg,onSubmitMsg:i.submitMsg,toCommentId:n},null,8,["setMsg","onSubmitMsg","toCommentId"])])):G("",!0),s("div",Es,[(h(!0),f(V,null,$(n.children,(o,_)=>(h(),f("div",{class:"comment_list",key:_},[s("div",Os,[s("div",Rs,[s("img",{src:o.avatar||i.defultImg,alt:""},null,8,Ts)]),s("div",Js,[s("div",js,[s("div",Qs,[s("span",As,d(o.nickName),1),u(" "+d(o.createTime),1)]),s("div",Ds,[s("i",{class:"iconfont icondianzan",onClick:a=>i.handleIcon(1,o)},null,8,Hs),u(d(o.dzNum)+" ",1),s("i",{class:"iconfont iconpinglunzu",onClick:a=>i.handleIcon(2,o)},null,8,Ps),u(d(o.plNum),1)])]),s("div",Xs,d(o.content),1),s("div",Gs,d(o.userForm),1)])])]))),128))])],512),[[X,n.openComment]])],2))),128))])])]),m(g)],4)}const ne=z(hs,[["render",Ks],["__scopeId","data-v-eb9a9cc6"]]);export{ne as default};
